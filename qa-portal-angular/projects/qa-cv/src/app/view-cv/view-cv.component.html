<div class="qa-app-title">
  Trainee - Maintain CV
</div>

<div style="display: flex; justify-content: center;">
  <mat-spinner [diameter]="70" *ngIf="loadingData"></mat-spinner>
</div>

<div *ngIf="!loadingData">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; font-size: 18px;">
    <h3>{{cvData?.fullName}}</h3>
    <div style="margin-left: auto; color: #004050"><b>CV Status:</b> {{cvData?.status || 'In Progress'}}</div>
  </div>

  <div class="cv-content-wrapper" (onSubmit)="onSubmit($event)">
    <section>
      <app-cv-card-base title="Personal Profile" [canComment]="canComment"
                        [feedback]="cvData?.profile?.profileFeedback">
        <app-cv-profile [profile]="cvData?.profile" (profileChange)="cvData.profile = $event" [canEdit]="canEdit">
        </app-cv-profile>
      </app-cv-card-base>
    </section>
    <section>
      <app-cv-card-base title="Hobbies and Interests" [canComment]="canComment"
                        [feedback]="cvData?.hobbies?.hobbiesFeedback">
        <app-cv-hobbies [hobbies]="cvData?.hobbies" (hobbiesChange)="cvData.hobbies = $event" [canEdit]="canEdit">
        </app-cv-hobbies>
      </app-cv-card-base>
    </section>
    <section>
      <app-cv-card-base #qualCard [feedback]="qualFeedback" [canComment]="canComment"
                        (feedbackChange)="onQualFeedbackChange($event)" [showOpenButton]="false">
        <app-cv-qualis-wrapper [qualifications]="cvData?.allQualifications"
                               (qualificationsChange)="cvData.allQualifications = $event"
                               (feedbackClick)="onQualFeedbackClick($event, qualCard)" [canEdit]="canEdit">
        </app-cv-qualis-wrapper>
      </app-cv-card-base>
    </section>
    <section>
      <app-cv-card-base #expCard [feedback]="workExpFeedback" [canComment]="canComment"
                        (feedbackChange)="onWorkExpFeedbackChange($event)" [showOpenButton]="false">
        <app-cv-work-exp-wrapper [experiences]="cvData?.allWorkExperience"
                                 (experiencesChange)="cvData.allWorkExperience = $event"
                                 (feedbackClick)="onWorkExpFeedbackClick($event, expCard)" [canEdit]="canEdit">
        </app-cv-work-exp-wrapper>
      </app-cv-card-base>
    </section>
    <section>
      <app-cv-card-base [showOpenButton]="false" title="Skills">
        <app-cv-skills [skills]="cvData?.allSkills[0]" (skillsChange)="cvData.allSkills[0] = $event"
                       [canEdit]="canEdit">
        </app-cv-skills>
      </app-cv-card-base>
    </section>
    <div class="button-row">

      <div style="width: 50%; display:flex; flex-direction: row; justify-content: left;">
        <button *ngIf="!canComment" mat-flat-button color="primary" (click)="onSave()" title="Save all Changes"
                [disabled]="!cvData || cvData.status==='For Review'">Save
        </button>
        <div *ngIf="!canComment" style="margin-right: 20px"></div>
        <button *ngIf="!canComment" mat-flat-button color="warn" (click)="openDialog()" title="Submit for Review"
                [disabled]="!cvData || cvData.status==='For Review'">Submit
        </button>

        <div *ngIf="canComment" style="margin-right: 20px">
          <button *ngIf="canComment" mat-flat-button color="primary" (click)="onApproveCv()" title="Aprrove Cv"
                  [disabled]="!cvData || cvData.status==='In Progress' || !cvData.status">Approve
          </button>
          <div *ngIf="canComment" style="margin-right: 20px"></div>
          <button *ngIf="canComment" mat-flat-button color="warn" (click)="onFailCv()" title="Fail Cv"
                  [disabled]="!cvData || cvData.status==='In Progress' || !cvData.status">Fail
          </button>
        </div>
      </div>

      <button style="margin-left: auto;" mat-flat-button color="primary" (click)="getPDF()" title="Open PDF"
              [disabled]="!cvData || cvData.status==='In Progress' || !cvData.status ">View PDF
      </button>

    </div>
  </div>
</div>
